version: '3.9'

services:
    proxy:
        # The official v2 Traefik docker image
        image: traefik:v2.9
        # Enables the web UI and tells Traefik to listen to docker
        command: --api.insecure=true --providers.docker
        ports:
            # The HTTP port
            - "80:80"
            # The Web UI (enabled by --api.insecure=true)
            - "8080:8080"
        volumes:
            # So that Traefik can listen to the Docker events
            - /var/run/docker.sock:/var/run/docker.sock
    borda:
        labels:
            - "traefik.http.routers.borda.rule=Host(`borda.localhost`)"
        build: .
        volumes:
            - .:/usr/app/
            - /usr/app/node_modules
        ports:
            - "3000:3000"
        env_file:
            - .env
        environment:
            DATABASE_URL: $DATABASE_URL
    # postgres:
    #     image: postgres:alpine
    #     ports:
    #         - "5432:5432"
    #     environment:
    #         - POSTGRES_USER=admin
    #         - POSTGRES_PASSWORD=secret
    #         - POSTGRES_DB=borda
    #     volumes:
    #         - ./.db/data:/var/lib/postgresql/data:Z
